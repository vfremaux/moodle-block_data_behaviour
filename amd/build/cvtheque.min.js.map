{"version":3,"file":"cvtheque.min.js","sources":["../src/cvtheque.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for controlling the sections.\n *\n * @module     block_data_behaviour/cvtheque_control\n * @package    block_data_behaviour\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// jshint unused: true, undef:true\ndefine(['jquery', 'core/log', 'core/config', 'block_data_cart/datacart'], function ($, log, cfg, datacart) {\n\n    var cvtheque = {\n\n        courseid: 0,\n\n        dataid: 0,\n\n        blockid: 0,\n\n        recordid: 0,\n\n        init: function (params) {\n\n            log.debug(\"AMD Cvtheque start init !\");\n            var isview;\n            var isedit;\n\n            cvtheque.courseid = params.courseid;\n            cvtheque.dataid = params.dataid;\n            cvtheque.recordid = params.recordid;\n\n            // Detect we have cvtheque environnement.\n            if ($('.cvthequetemplate').length === 0) {\n                log.debug(\"AMD Cvtheque not found in DOM !\");\n                return;\n            }\n\n            isview = $('.cvthequetemplate.view').length > 0;\n            isedit = $('.cvthequetemplate.edit').length > 0;\n\n            if (isedit) {\n                // Sync/force some fields values from profile (only if creating the record.\n                if (parseInt($('INPUT[name=\"rid\"]').val()) === 0) {\n                    var profileurl = cfg.wwwroot + '/blocks/data_behaviour/ajax/service.php';\n                    profileurl += '?what=getuserinfo';\n                    profileurl += '&courseid=' + cvtheque.courseid;\n                    profileurl += '&dataid=' + cvtheque.dataid;\n                    $.get(profileurl, function (data) {\n                        $('#cv_nom INPUT').val(data.cv_nom);\n                        $('#cv_prenom INPUT').val(data.cv_prenom);\n                        $('#cv_ville INPUT').val(data.cv_ville);\n                        $('#cv_tel1 INPUT').val(data.cv_tel1);\n                        $('#cv_tel2 INPUT').val(data.cv_tel2);\n                        $('#cv_mail INPUT').val(data.cv_mail);\n                        $('#cv_adresse INPUT').val(data.cv_adresse);\n                    }, 'json');\n                }\n\n                // Set initial handlers\n\n                $('.delete-fieldset div.btn').addClass('dimmed');\n\n                // $('.delete-fieldset').bind('click', this.delete_fieldset);\n                $('.data-fs-master').on('change', '.mod-data-input', [], this.set_fieldset_controls);\n\n                // Check all master fields initial states.\n                $('.data-fs-master .mod-data-input').trigger('change');\n\n                // Expand all selects.\n                $('.cvthequetemplate.edit select[multiple=\"multiple\"]').attr('size', 8);\n\n                // Initiate status color\n                let publishedstate = $('#cv_state-value input[value*=\"Pub\"]').is(':checked');\n                // let draftstate = $('#cv_state-value input[value*=\"Brou\"]').is(':checked');\n                if (publishedstate) {\n                    $('#cv_state-value').addClass('published');\n                } else {\n                    if (!publishedstate) {\n                        $('#cv_state-value input[value*=\"Brou\"]').prop('checked', true);\n                    }\n                    $('#cv_state-value').addClass('draft');\n                }\n                $('#cv_state-value input[value*=\"Pub\"]').bind('click', this.publish);\n                $('#cv_state-value input[value*=\"Brou\"]').bind('click', this.unpublish);\n                log.debug(\"AMD Cvtheque Initialized for editing !\");\n            }\n\n            if (isview) {\n                this.check_all_fieldsets();\n\n                // Add \"add to cart handler\"\n                $('#id-add-to-cart').on('click', this.add_to_data_cart);\n                $('#id-add-to-cart').attr('data-recordid', cvtheque.recordid);\n                $('#id-add-to-cart').attr('data-dataid', cvtheque.dataid);\n                log.debug(\"AMD Cvtheque Initialized for viewing \" + cvtheque.dataid + \"/\" + cvtheque.recordid + \" !\");\n            }\n        },\n\n        // Check fieldset empty state and show relevant info.\n        check_all_fieldsets: function () {\n            var fieldsetelm, fselm;\n\n            $('.data-fs-master').each(function () {\n                if ( $(this).html() != '' ) {\n                    // fieldset has content.\n                    fieldsetelm = $(this).closest('.multiple-fieldset');\n                    fselm = fieldsetelm.attr('data-fs');\n\n                    // Hide set-empty of the set.\n                    log.debug('Hiding empty signal on fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"0\"]');\n                    $('fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"0\"]').addClass('set-hidden');\n\n                    // Show this fieldset.\n                    fieldsetelm.removeClass('set-hidden');\n                }\n            });\n        },\n\n        // Examinates the completion state of th emaster field and\n        // sets the appropriate state of the \"add more\" button.\n        set_fieldset_controls: function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n\n            var that, fieldsetelm, fselm, fsix, fieldsetinputs, fieldsetselects, fieldsettextareas, masterinput;\n            var isfile, isempty, filehiddenfieldelm;\n\n            that = $(this);\n\n            log.debug(\"AMD Cvtheque Setting \" + that.attr('id') + \" initial state !\");\n\n            // identify fselm and fsix\n            fieldsetelm = that.closest('.multiple-fieldset');\n            fieldsetinputs = $('#' + fieldsetelm.attr('id') + ' :not(.template-token.data-fs-master) INPUT');\n            fieldsetselects = $('#' + fieldsetelm.attr('id') + ' :not(.template-token.data-fs-master) SELECT');\n            fieldsettextareas = $('#' + fieldsetelm.attr('id') + ' :not(.template-token.data-fs-master) TEXTAREA');\n            masterinput = $('#' + fieldsetelm.attr('id') + ' .template-token.data-fs-master INPUT');\n            fselm = fieldsetelm.attr('data-fs');\n            fsix = fieldsetelm.attr('data-fsix');\n\n            log.debug(\"AMD Cvtheque Setting : Seeing val '\" + that.val() + \"' for \" + fselm + ':' + fsix + \" !\");\n\n            isfile = that.children('.filemanager').length > 0;\n            if (isfile) {\n                log.debug(\"AMD Cvtheque : isfile ? \" + isfile);\n                // Direct testing is not possible as file manager is not yet loaded.\n                // isempty = filemanagerelm.hasClass('fm-nofiles');\n                // so test by ajax.\n                filehiddenfieldelm = fieldsetelm.find('input[type=\"hidden\"]').first();\n                var url = cfg.wwwroot + '/blocks/data_behaviour/ajax/service.php';\n                url += '?what=checkfilearea';\n                url += '&filearea=draft&itemid=' + filehiddenfieldelm.val();\n                $.ajax(url, {\n                    'success': function(result) {\n                    isempty = result.isempty;\n                },\n                    'async': false,\n                    'dataType': 'json'}\n                );\n                log.debug(\"AMD Cvtheque : isempty ? \" + isempty);\n            }\n\n            if ((!isfile && (that.val() === '' || that.val() === undefined)) || (isfile && isempty)) {\n                // Will ignore last one as button does not exist.\n                cvtheque.disable_add_one_more(fselm, parseInt(fsix) + 1);\n                fieldsetinputs.prop('disabled', true);\n                fieldsetselects.prop('disabled', true);\n                fieldsettextareas.prop('disabled', true);\n                masterinput.prop('disabled', null);\n                cvtheque.disable_delete(fselm, fsix);\n            } else {\n                // Will ignore last one as button does not exist.\n                $('fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"]').removeClass('set-hidden');\n                cvtheque.enable_add_one_more(fselm, parseInt(fsix) + 1);\n                cvtheque.disable_add_one_more(fselm, fsix); // Disable previous add_more.\n                fieldsetinputs.prop('disabled', null);\n                fieldsetselects.prop('disabled', null);\n                fieldsettextareas.prop('disabled', null);\n                cvtheque.enable_delete(fselm, fsix);\n            }\n        },\n\n        /*\n         * Potentially on all master input field whose null value tells it is empty.\n         * Be carefull that add_more adresses the next index in fsix.\n         */\n        enable_add_one_more: function (fselm, fsix) {\n            log.debug(\"AMD Cvtheque Enabling add one more : \" + fselm + ':' + fsix + \" !\");\n            $('.add-more[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"] div.btn').removeClass('dimmed');\n            $('.add-more[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"]').bind('click', cvtheque.add_one_more);\n        },\n\n        disable_add_one_more: function (fselm, fsix) {\n            log.debug(\"AMD Cvtheque Disabling add one more : \" + fselm + ':' + fsix + \" !\");\n            $('.add-more[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"] div.btn').addClass('dimmed');\n            $('.add-more[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"]').unbind('click', cvtheque.add_one_more);\n        },\n\n        /*\n         * Potentially on all master input field whose null value tells it is empty.\n         */\n        enable_delete: function (fselm, fsix) {\n            log.debug(\"AMD Cvtheque Enabling delete : \" + fselm + ':' + fsix + \" !\");\n            $('.delete-fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"] div.btn').removeClass('dimmed');\n            $('.delete-fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"]').bind('click', cvtheque.delete_fieldset);\n        },\n\n        disable_delete: function (fselm, fsix) {\n            log.debug(\"AMD Cvtheque Disabling delete : \" + fselm + ':' + fsix + \" !\");\n            $('.delete-fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"] div.btn').addClass('dimmed');\n            $('.delete-fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"]').unbind('click', cvtheque.delete_fieldset);\n        },\n\n        add_one_more: function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n\n            var that, fselm, fsix, prevfsix, fieldsetelm, fieldsetinputs, fieldsetselects, fieldsettextareas;\n            that = $(this);\n\n            fieldsetelm = that.closest('.multiple-fieldset');\n            fieldsetinputs = $('#' + fieldsetelm.attr('id') + ' :not(.template-token.data-fs-master) INPUT');\n            fieldsetselects = $('#' + fieldsetelm.attr('id') + ' :not(.template-token.data-fs-master) SELECT');\n            fieldsettextareas = $('#' + fieldsetelm.attr('id') + ' :not(.template-token.data-fs-master) TEXTAREA');\n\n\n            fselm = that.attr('data-fs');\n            fsix = that.attr('data-fsix');\n            prevfsix = parseInt(fsix) - 1;\n            $('.multiple-fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + fsix + '\"]').toggleClass('set-hidden');\n            cvtheque.disable_add_one_more(fselm, prevfsix);\n            // wake up fields.\n            fieldsetinputs.prop('disabled', null);\n            fieldsetselects.prop('disabled', null);\n            fieldsettextareas.prop('disabled', null);\n        },\n\n        /**\n         * Synopsys : if first element of a set (set-first), than empty all set inputs, but keep the form visible.\n         * if not first, If next set is hidden (empty) or does not exist (last), empty values and hide. If next set\n         * is shown, copy all values in current, and iterate to next.\n         */\n        delete_fieldset: function (e) {\n\n            e.stopPropagation();\n            e.preventDefault();\n\n            var that, fselm, fsix, jqfieldsetelm, loopctl, nextfsix, nextjqfieldset, textareaelm, i;\n            that = $(this);\n            fselm = that.attr('data-fs');\n            fsix = that.attr('data-fsix');\n\n            log.debug(\"AMD Cvtheque deleting/emptying : \" + fselm + ':' + fsix + \" !\");\n\n            jqfieldsetelm = that.closest('.multiple-fieldset');\n\n            // Empty everything in the deleted element.\n            $('input[type=\"text\"]', jqfieldsetelm).val(null);\n            $('textarea', jqfieldsetelm).html(null);\n            $('select', jqfieldsetelm).val(null);\n            $('input[type=\"checkbox\"]', jqfieldsetelm).attr('checked', null);\n            $('input[type=\"radio\"]', jqfieldsetelm).attr('checked', null);\n\n            // Additional cleaning if a textarea is a whisiwhyg\n            textareaelm = $('input[type=\"textarea\"]', jqfieldsetelm).first();\n            if (textareaelm !== undefined) {\n                $('#' + textareaelm.attr('id') + 'editable').html('');\n            }\n\n            nextfsix = 0 + parseInt(fsix) + 1; // force arithmetic.\n\n            // Disable the add more button and the delete.\n            cvtheque.disable_add_one_more(fselm, nextfsix);\n            cvtheque.disable_delete(fselm, fsix);\n\n            nextfsix = 0 + parseInt(fsix) + 1; // force arithmetic.\n            nextjqfieldset = jqfieldsetelm.next();\n            if (nextjqfieldset != undefined) {\n                loopctl = true;\n            } else {\n                log.debug(\"AMD Cvtheque finding no more elements : \" + fselm + ':' + nextfsix + \" !\");\n            }\n            while (loopctl) {\n                log.debug(\"AMD Cvtheque processing : \" + fselm + ':' + nextfsix + \" !\");\n                log.debug(\"AMD Cvtheque previous : \" + fselm + ':' + jqfieldsetelm.attr('data-fsix') + \" !\");\n                if (nextjqfieldset == undefined || nextjqfieldset.length == 0) {\n                    log.debug(\"AMD Cvtheque found \" + fselm + ':' + (0 + parseInt(nextfsix) - 1) + \" was last one !\");\n                    jqfieldsetelm.toggleClass('set-hidden');\n                    // Empty everything in the last element.\n                    $('input[type=\"text\"]', jqfieldsetelm).val(null);\n                    $('textarea', jqfieldsetelm).html(null);\n                    $('select', jqfieldsetelm).val(null);\n                    $('input[type=\"checkbox\"]', jqfieldsetelm).attr('checked', null);\n                    $('input[type=\"radio\"]', jqfieldsetelm).attr('checked', null);\n\n                    // Additional cleaning if a textarea is a whisiwhyg\n                    textareaelm = $('input[type=\"textarea\"]', jqfieldsetelm).first();\n                    if (textareaelm !== undefined) {\n                        $('#' + textareaelm.attr('id') + 'editable').html('');\n                    }\n\n                    // Allow adding one more to previous item\n                    cvtheque.disable_add_one_more(fselm, nextfsix);\n                    cvtheque.disable_delete(fselm, nextfsix - 1);\n                    cvtheque.enable_add_one_more(fselm, nextfsix - 1);\n                    // Stop processing.\n                    loopctl = false;\n\n                } else {\n                    log.debug(\"AMD Cvtheque current : \" + fselm + ':' + nextjqfieldset.attr('data-fsix') + \" !\");\n                    // Next exists but might be empty or not\n                    if (nextjqfieldset.hasClass('set-hidden')) {\n                        log.debug(\"AMD Cvtheque current was hidden (empty), so hide the previous\");\n                        jqfieldsetelm.toggleClass('set-hidden');\n                        // Ensure previous turns back empty.\n                        $('input[type=\"text\"]', jqfieldsetelm).val(null);\n                        $('textarea', jqfieldsetelm).html(null);\n                        $('select', jqfieldsetelm).val(null);\n                        $('input[type=\"checkbox\"]', jqfieldsetelm).attr('checked', null);\n                        $('input[type=\"radio\"]', jqfieldsetelm).prop('checked', null);\n\n                        // Allow adding one more to previous item\n                        cvtheque.disable_add_one_more(fselm, nextfsix - 1);\n                        cvtheque.disable_add_one_more(fselm, nextfsix - 2);\n                        cvtheque.enable_add_one_more(fselm, nextfsix);\n                    } else {\n                        log.debug(\"AMD Cvtheque copy to n-1 !\");\n                        // Next is not empty. We need copy values.\n                        var textinputs = $('input[type=\"text\"]', nextjqfieldset);\n                        for (i = 0; i < textinputs.length ; i++) {\n                            cvtheque.copy_text(textinputs[i], jqfieldsetelm, nextfsix);\n                        }\n\n                        var textareas = $('textarea', nextjqfieldset);\n                        for (i = 0; i < textareas.length ; i++) {\n                            cvtheque.copy_textarea(textareas[i], jqfieldsetelm, nextfsix);\n                        }\n\n                        var selects = $('select', nextjqfieldset);\n                        for (i = 0; i < selects.length ; i++) {\n                            cvtheque.copy_select(selects[i], jqfieldsetelm, nextfsix);\n                        }\n\n                        var checkboxes = $('input[type=\"checkbox\"]', nextjqfieldset);\n                        for (i = 0; i < checkboxes.length ; i++) {\n                            cvtheque.copy_check(checkboxes[i], jqfieldsetelm, nextfsix);\n                        }\n\n                        var radios = $('input[type=\"radio\"]', nextjqfieldset);\n                        for (i = 0; i < radios.length ; i++) {\n                            cvtheque.copy_radio(radios[i], jqfieldsetelm, nextfsix);\n                        }\n                        cvtheque.enable_add_one_more(fselm, nextfsix);\n                        cvtheque.enable_delete(fselm, nextfsix - 1);\n                    }\n\n                    nextfsix = 0 + parseInt(nextfsix) + 1; // force arithmetic.\n                    jqfieldsetelm = nextjqfieldset;\n                    nextjqfieldset = $('.multiple-fieldset[data-fs=\"' + fselm + '\"][data-fsix=\"' + nextfsix + '\"]');\n                }\n            }\n        },\n\n        /*\n         * element is the element to copy\n         * Copy path : As mod_data hides how the input element is done, we need to\n         * So we need to : climb up to TD element, shift to n-1 TD element and drop\n         * back to the input. TD ids chain with the datafield shortname + fsix.\n         */\n        copy_text: function(element, jqfieldsetelm, nextfsix) {\n            var tdid = $(element).closest('td').attr('id');\n            log.debug(\"Selecting value in element name \" + $(element).attr('name'));\n            var inputvalue = $(element).val();\n            log.debug(\"Input value is \" + inputvalue);\n\n            // Find target\n            var lastfsix = 0 + parseInt(nextfsix) - 1;\n            tdid = tdid.replace(/[0-9]+$/, '');\n            var lasttdid = tdid + lastfsix;\n            var targetinput = $('#' + lasttdid + ' input[type=\"text\"]');\n            log.debug(\"Transfering value '\" + inputvalue + \"' to element name \" +\n                    targetinput.attr('name') + ' in td of id ' + lasttdid);\n            targetinput.val(inputvalue);\n        },\n\n        copy_textarea: function(element, jqfieldsetelm, nextfsix) {\n            var tdid = $(element).closest('td').attr('id');\n            log.debug(\"Selecting value in element name \" + $(element).attr('name'));\n            var inputvalue = $(element).val();\n            log.debug(\"Input value is \" + inputvalue);\n\n            var lastfsix = 0 + parseInt(nextfsix) - 1;\n            tdid = tdid.replace(/[0-9]+$/, '');\n            var lasttdid = tdid + lastfsix;\n            var targetinput = $('#' + lasttdid + ' textarea');\n            targetinput.val(inputvalue);\n\n            // Additional cleaning if a textarea is a whisiwhyg\n            var targetareaid = targetinput.attr('id');\n            $('#' + targetareaid + 'editable').html(inputvalue);\n        },\n\n        /**\n         * Special care to date selects that are three combined selects with _day, _month, _year extensions.\n         */\n        copy_select: function(element, jqfieldsetelm, nextfsix) {\n            var td = $(element).closest('td');\n            var tdid = td.attr('id');\n            if (!td.hasClass('is-date')) {\n                // Play the simple case. There is only one select in the fieldset.\n                log.debug(\"Selecting value in element name \" + $(element).attr('name'));\n                var inputvalue = $(element).val();\n                log.debug(\"Input value is \" + inputvalue);\n\n                var lastfsix = 0 + parseInt(nextfsix) - 1;\n                tdid = tdid.replace(/[0-9]+$/, '');\n                var lasttdid = tdid + lastfsix;\n                var targetinput = $('#' + lasttdid + ' select');\n                targetinput.val(inputvalue);\n            } else {\n                // Play the uggly case. the element is \"one of\" the three date components.\n                log.debug(\"Selecting value in element name \" + $(element).attr('name'));\n                var inputvalue = $(element).val();\n                log.debug(\"Input value is \" + inputvalue);\n\n                // Detect wich component we are.\n                var component;\n                if ($(element).attr('name').match('day$')) {\n                    component = 'day';\n                } else if ($(element).attr('name').match('month$')) {\n                    component = 'month';\n                } else {\n                    component = 'year';\n                }\n\n                var lastfsix = 0 + parseInt(nextfsix) - 1;\n                tdid = tdid.replace(/[0-9]+$/, '');\n                var lasttdid = tdid + lastfsix;\n                var targetinput = $('#' + lasttdid + ' select[name$=\"' + component +'\"]'); // Get by \"endsWith\" filter.\n                targetinput.val(inputvalue);\n            }\n        },\n\n        copy_check: function(element, jqfieldsetelm, nextfsix) {\n            var tdid = $(element).closest('td').attr('id');\n            log.debug(\"Selecting value in element name \" + $(element).attr('name'));\n            var inputchecked = $(element).attr('checked');\n\n            var lastfsix = 0 + parseInt(nextfsix) - 1;\n            tdid = tdid.replace(/[0-9]+$/, '');\n            var lasttdid = tdid + lastfsix;\n            var targetinput = $('#' + lasttdid + ' input[type=\"checkbox\"]');\n            targetinput.attr('checked', inputchecked);\n        },\n\n        copy_radio: function(element, jqfieldsetelm, nextfsix) {\n            var tdid = $(element).closest('td').attr('id');\n            log.debug(\"Selecting value in element name \" + $(element).attr('name'));\n            var inputchecked = $(element).attr('checked');\n\n            var lastfsix = 0 + parseInt(nextfsix) - 1;\n            tdid = tdid.replace(/[0-9]+$/, '');\n            var lasttdid = tdid + lastfsix;\n            var targetinput = $('#' + lasttdid + ' input[type=\"radio\"]');\n            targetinput.prop('checked', inputchecked).trigger('click');\n        },\n\n        publish: function(e) {\n            e.stopPropagation();\n            e.preventDefault();\n            $('#cv_state-value').removeClass('draft');\n            $('#cv_state-value').addClass('published');\n        },\n\n        unpublish: function(e) {\n            e.stopPropagation();\n            e.preventDefault();\n            $('#cv_state-value').removeClass('published');\n            $('#cv_state-value').addClass('draft');\n        },\n\n        add_to_data_cart: function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n\n            var that, recordid;\n            that = $(this);\n            recordid = that.attr('data-recordid');\n            datacart.add_record(recordid);\n        }\n\n    };\n\n    return cvtheque;\n});\n\n"],"names":["define","$","log","cfg","datacart","cvtheque","courseid","dataid","blockid","recordid","init","params","isview","debug","length","parseInt","val","profileurl","wwwroot","get","data","cv_nom","cv_prenom","cv_ville","cv_tel1","cv_tel2","cv_mail","cv_adresse","addClass","on","this","set_fieldset_controls","trigger","attr","publishedstate","is","prop","bind","publish","unpublish","check_all_fieldsets","add_to_data_cart","fieldsetelm","fselm","each","html","closest","removeClass","e","that","fsix","fieldsetinputs","fieldsetselects","fieldsettextareas","masterinput","isfile","isempty","filehiddenfieldelm","stopPropagation","preventDefault","children","find","first","url","ajax","result","undefined","disable_add_one_more","disable_delete","enable_add_one_more","enable_delete","add_one_more","unbind","delete_fieldset","prevfsix","toggleClass","jqfieldsetelm","loopctl","nextfsix","nextjqfieldset","textareaelm","i","next","hasClass","textinputs","copy_text","textareas","copy_textarea","selects","copy_select","checkboxes","copy_check","radios","copy_radio","element","tdid","inputvalue","lastfsix","lasttdid","replace","targetinput","targetareaid","td","component","match","inputchecked","add_record"],"mappings":"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"}